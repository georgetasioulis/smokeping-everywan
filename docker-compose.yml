version: '3.8'

services:
  smokeping:
    image: sistemasminorisa/smokeping:latest
    container_name: smokeping
    hostname: smokeping-master
    ports:
      - "8081:80"
    cap_add:
      - NET_RAW
      - NET_ADMIN
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      - SMOKEPING_OWNER=SmokePing Admin
      - SMOKEPING_CONTACT=admin@example.com
      - SMOKEPING_TITLE=SmokePing Monitoring
      - SMOKEPING_BRAND_NAME=
      - SMOKEPING_BRAND_URL=
      - SMOKEPING_LOGO_URL=images/logo.svg
      - SMOKEPING_HOSTNAME=smokeping-master
      - TRACEPING_INTERVAL=300
      - TRACEPING_RETENTION_DAYS=365
    volumes:
      - ./config:/config
      - ./data:/data
      - ./logs:/logs
    restart: unless-stopped
    networks:
      - smokeping-net

  nginx:
    image: nginx:alpine
    container_name: smokeping-nginx
    ports:
      - "8085:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/smokeping.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - smokeping
    restart: unless-stopped
    networks:
      - smokeping-net

networks:
  smokeping-net:
    driver: bridge
